<!DOCTYPE html>
<html>
<head>
  	<meta charset="utf-8">
  	<meta http-equiv="X-UA-Compatible" content="IE=edge">
  	<title><%= title %></title>
  	<link rel="icon" href="static/img/icon.jpg">
  	
  	<!-- Tell the browser to be responsive to screen width -->
  	<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

	<!-- Bootstrap 3.3.7 -->
  	<link rel="stylesheet" href="static/bootstrap/css/bootstrap.min.css">

  	<!-- Font Awesome -->
	<link rel="stylesheet" href="static/bootstrap/plugin/font-awesome/css/font-awesome.css">

	<!-- Ionicons -->
	<link rel="stylesheet" href="static/bootstrap/plugin/Ionicons/css/ionicons.min.css">

  	<!-- bootstrap slider -->
  	<link rel="stylesheet" href="static/bootstrap/plugin/bootstrap-slider/slider.css">

	<!-- Theme style -->
	<link rel="stylesheet" href="static/bootstrap/dist/css/AdminLTE.min.css">

	<!-- AdminLTE Skins. Choose a skin from the css/skins
	       folder instead of downloading all of them to reduce the load. -->
	<link rel="stylesheet" href="static/bootstrap/dist/css/skins/_all-skins.min.css">


	<link rel="stylesheet" href="static/js/toast/toastr.css">
	<link rel="stylesheet" href="static/js/sweetalert/sweetalert.css">

	<!-- <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic"> -->
	<style>
			body {
				/*background-color: #000;
				color: #000;*/
				margin: 0px;
				overflow: hidden;
			}

			#info {
				position: absolute;
				padding: 10px;
				width: 100%;
				text-align: center;
			}

			a {
				/*text-decoration: underline;*/
				cursor: pointer;
				/*color: #bbb;*/
			}
			
			.ac {  /* prevent dat-gui from being selected */
				-webkit-user-select: none;
				-moz-user-select: none;
				-ms-user-select: none;
				user-select: none;
			}
			.no-pointer-events {
				pointer-events: none;
			}
			.control-disabled {
				color: #888;
				text-decoration: line-through;
			}

			#dat {
				left: 10;
				position: absolute;
				top: 0;
				z-Index: 200;
			}


			#stats{
				position: fixed;
			    bottom: 0px;
			    left: 0px;
			    cursor: pointer;
			    opacity: 0.9;
			    z-index: 10000;
			}

	</style>
</head>



<body class="hold-transition skin-blue sidebar-mini sidebar-collapse">

	<div class="wrapper">





	  	<header class="main-header">
	    	<!-- Logo -->
	    	<a href="#" class="logo">
	      		<span class="logo-mini"><b>3</b>DH</span>
	      		<span class="logo-lg"><b>Humanoid</b>3D</span>
	    	</a>

		    <nav class="navbar navbar-static-top">
		     	<a href="#" class="sidebar-toggle" data-toggle="push-menu" role="button" id="mb_tb_btn">
		        	<span class="sr-only">Toggle navigation</span>
		      	</a>


		      	<div class="navbar-custom-menu">
	        		<ul class="nav navbar-nav">
	          			<li>
	            			<a href="#" data-toggle="control-sidebar" id="sb_tb_btn">
	            			<i class="fa fa-bars" id="ic_sb_tb_tb"></i></a>
	          			</li>
	        		</ul>
	      		</div>

		    </nav>
	  	</header>







	  	<!-- Left side column. contains the logo and sidebar -->
	  	<aside class="main-sidebar" id="ms">
	    	<!-- sidebar: style can be found in sidebar.less -->
	   		<section class="sidebar">
	   			<!-- sidebar menu: : style can be found in sidebar.less -->
	      		<ul class="sidebar-menu" data-widget="tree">
	        		<li class="header">MAIN NAVIGATION</li>
	        		
	        		<li id="mb_1">
	          			<a href="/boolean_animation">
	            			<i class="fa fa-dashboard"></i> <span>Boolean Animation</span>
	            			<!-- <span class="pull-right-container"> 
	              				<i class="fa fa-angle-left pull-right"></i>
	            			</span> -->
	          			</a>
	        		</li>


	        		<li id="mb_2">
	          			<a href="/map_control">
	            			<i class="fa fa-gg"></i> <span>Interactive Motion</span>
	          			</a>
	        		</li> <!--  -->


	        		<li id="mb_3">
	          			<a href="/custom_motion"> <!--  -->
	            			<i class="fa fa-object-ungroup"></i> <span>Custom Motion</span>
	          			</a>
	        		</li>


	        		<!--
	        		<li>
	          			<a href="#">
	            			<i class="fa fa-th"></i> <span>Widgets</span>
				            <span class="pull-right-container">
				              	<small class="label pull-right bg-green">new</small>
				            </span>
	          			</a>
	        		</li>

	        		<li class="treeview">
				        <a href="#">
				            <i class="fa fa-edit"></i> <span>Forms</span>
				            <span class="pull-right-container">
				              	<i class="fa fa-angle-left pull-right"></i>
				            </span>
				        </a>
				        <ul class="treeview-menu">
				            <li>
				            	<a href="pages/forms/general.html">
				            		<i class="fa fa-circle-o"></i> General Elements
				            	</a>
				            </li>
				            <li>
				            	<a href="pages/forms/advanced.html">
				            		<i class="fa fa-circle-o"></i> Advanced Elements
				            	</a>
				            </li>
				        </ul>
			        </li>
			        -->
	        	</ul>
	   		</section>
	   	</aside>








	  	<div class="content-wrapper" id="wrapper">
	  		<div class="row">
	  			<div class="col-lg-12" style="padding-left: 0px;">
					<div class="row">
						<div id="container" class="col-md-12" style="padding-left: -15px;">
							<div id="info" class="col-md-3" style="font-family: Monospace;"><%= title %> <br/> <%= name %> <br/> <strong><font size="5"> <%= content %> </font></strong></div>
							<!-- <div class="col-md-3"></div> -->
							<div id="dat" class="col-md-3"></div>
							<div id="stats" class="col-md-3"></div>
						</div>
					</div>
				</div>
			</div>
	    </div>






	    <!-- <footer class="main-footer">
		    <div class="pull-right hidden-xs">
		      	<b>Version</b> 1.0.0
		    </div>
	    	<strong>
	    		Copyright &copy; 2018 <a href="#">ZenZen</a>.
	    	</strong> All rights reserved.
	  	</footer> -->








	  	<!-- Control Sidebar -->
	 	<aside class="control-sidebar control-sidebar-dark" id="navbar">
		    <!-- Create the tabs -->
		    <!-- <ul class="nav nav-tabs nav-justified control-sidebar-tabs">
		      	<li class="active">
		      		<a href="#control-sidebar-home-tab" data-toggle="tab">
		      			<i class="fa fa-puzzle-piece"></i>
		      		</a>
		      	</li>
		      	<!-- <li>
		      		<a href="#control-sidebar-settings-tab" data-toggle="tab">
		      			<i class="fa fa-history"></i>
		      		</a>
		      	</li> --
		    </ul> -->

		    <!-- Tab panes -->
		    <div class="tab-content">

	      		<!-- Home tab content -->
	      		<div class="tab-pane active" id="control-sidebar-home-tab">
	      			<h3 class="control-sidebar-heading" style="margin-top:0px">
	      				<i class="fa fa-puzzle-piece"></i> Robot Parts
	      			</h3>
	      			<div class="col-lg-12 ct_slider" style="overflow-y: scroll;">
                        <button type="button" class="btn btn-block btn-default btn-sm load_model" dt-id="1">
                        	<img class="img-responsive" src="static/img/boolean_icon/larm.png" style="margin: 0 auto;" alt="Photo">
                        	<br/>
                        	<strong>Arm Part Animation</strong>
                        </button>

                        <br>

                        <button type="button" class="btn btn-block btn-default btn-sm load_model" dt-id="2" >
                        	<img class="img-responsive" src="static/img/boolean_icon/shoulder.png" style="margin: 0 auto;" alt="Photo">
                        	<br/>
                        	<strong>Shoulder Part Animation</strong>
                        </button>
                        <br>

                        <button type="button" class="btn btn-block btn-default btn-sm load_model" dt-id="3">
                        	<img class="img-responsive" src="static/img/boolean_icon/ankle.png" style="margin: 0 auto;" alt="Photo">
                        	<br/>
                        	<strong>Ankle Part Animation</strong>
                        </button>
                        <br>

                        <button type="button" class="btn btn-block btn-default btn-sm load_model" dt-id="4">
                        	<img class="img-responsive" src="static/img/boolean_icon/calves.png" style="margin: 0 auto;" alt="Photo">
                        	<br/>
                        	<strong>Calve Part Animation</strong>
                        </button>
                        <br>


                        <button type="button" class="btn btn-block btn-default btn-sm load_model" dt-id="5">
                        	<img class="img-responsive" src="static/img/boolean_icon/thigh.png" style="margin: 0 auto;" alt="Photo">
                        	<br/>
                        	<strong>Thigh Part Animation</strong>
                        </button>
                        <br>

                        <button type="button" class="btn btn-block btn-default btn-sm load_model" dt-id="6">
                        	<img class="img-responsive" src="static/img/boolean_icon/body.png" style="margin: 0 auto;" alt="Photo">
                        	<br/>
                        	<strong>Body Part Animation</strong>
                        </button>
                        <br>


                        <button type="button" class="btn btn-block btn-default btn-sm load_model" dt-id="7">
                        	<img class="img-responsive" src="static/img/boolean_icon/all.png" style="margin: 0 auto;" alt="Photo">
                        	<br/>
                        	<strong>Full Part Animation</strong>
                        </button>
	      			</div>

	      			<!-- <button type="button" style="margin-top:+20px" class="btn btn-block btn-default btn-sm">Pause</button> -->

      				<a class="btn btn-app" id="btn_pause" dt-st="0" style="margin-top:+20px">
	                	<i class="fa fa-pause" id="ic_pause"></i> 
	                	<span id="sp_pause">Pause</span>
	              	</a>
      				<a class="btn btn-app" id="btn_play" dt-st="1" style="margin-top:+20px">
	                	<i class="fa fa-play" id="ic_play"></i> 
	                	<span id="sp_play">Play</span>
	              	</a>

	      			

	      		</div>


	      		<!-- Settings tab content -->
	      		<!-- <div class="tab-pane" id="control-sidebar-settings-tab">
	      			<h3 class="control-sidebar-heading">Recent Activity</h3>
	        		<ul class="control-sidebar-menu" id="motion_history_content">
			         
	       			</ul>
	        		<!-- /.control-sidebar-menu --
	      		</div> -->
	     		 <!-- /.tab-pane -->
	    	</div>
	  	</aside>
		<!-- /.control-sidebar -->
		<!-- Add the sidebar's background. This div must be placed
		       immediately after the control sidebar -->
	  	<div class="control-sidebar-bg"></div>






	</div>



		<!-- THREE JS PLUGIN -->
	<script src="static/js/three.js/three.min.js"></script>
	<script src="static/js/three.js/Detector.js"></script>
	<script src="static/js/three.js/OrbitControls.js"></script>
	<script src="static/js/three.js/stats.min.js"></script>
	<script src="static/js/three.js/dat.gui.min.js"></script>
	<script src="static/js/three.js/DragControls.js"></script>
	<script src="static/js/three.js/TrackballControls.js"></script>

	<!-- <script src="static/js/timeliner/timeliner_gui.min.js"></script>
	<script src="static/js/timeliner/TimelinerController.js"></script> -->



	<!-- THREE JS PLUGIN -->
	<script src="static/js/app/app.js"></script>


	<!-- jQuery 3 -->
	<script src="static/bootstrap/plugin/jquery/dist/jquery.min.js"></script>
  	
	<!-- Bootstrap 3.3.7 -->
	<script src="static/bootstrap/plugin/bootstrap/dist/js/bootstrap.min.js"></script>

	<!-- Slimscroll -->
	<script src="static/bootstrap/plugin/jquery-slimscroll/jquery.slimscroll.min.js"></script>
	<!-- FastClick -->
	<script src="static/bootstrap/plugin/fastclick/lib/fastclick.js"></script>

	<script src="static/bootstrap/plugin/moment/min/moment.min.js"></script>
	<!-- AdminLTE App -->
	<script src="static/bootstrap/dist/js/adminlte.min.js"></script>
	<!-- AdminLTE for demo purposes -->
	<script src="static/bootstrap/dist/js/demo.js"></script>
	<!-- 
	<script src="static/bootstrap/plugin/bootstrap-slider/bootstrap-slider.js"></script>
	<script>
	  	$(function () {
	    	/* BOOTSTRAP SLIDER */
	    	$('.slider').slider()
	  	})
	</script>
	-->



	<!-- JAVASCRIPT LIBRARY-->
	<script src="static/js/toast/toastr.min.js"></script>
	<script src="static/js/sweetalert/sweetalert.min.js"></script>
	<script src="static/js/mathjs/math.js"></script>
	<script src="static/js/web_socket.js"></script>
	<script src="static/js/underscore-min.js"></script>

	<script src="static/bootstrap/plugin/pace.min.js"></script>
	<!-- JAVASCRIPT LIBRARY-->






	<script type="x-shader/x-fragment" id="fragmentShaderDepth">
		#include <packing>

		uniform sampler2D texture;
		varying vec2 vUV;

		void main() {

			vec4 pixel = texture2D( texture, vUV );

			if ( pixel.a < 0.5 ) discard;

			gl_FragData[ 0 ] = packDepthToRGBA( gl_FragCoord.z );

		}
	</script>




	<script type="x-shader/x-vertex" id="vertexShaderDepth">

		varying vec2 vUV;

		void main() {

			vUV = 0.75 * uv;

			vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

			gl_Position = projectionMatrix * mvPosition;

		}
	</script>





	<script>

		if ( ! Detector.webgl ) Detector.addGetWebGLMessage();

		var stats;
		var camera, scene, renderer, cameraControls;
		var mixers = [];
		var clock = new THREE.Clock();
		var is_play = 0;

		var clothGeometry;
		var sphere;
		var object;
		var canvas_height = window.innerHeight, canvas_width = document.getElementById('container').offsetWidth;

		var container = document.getElementById( 'container' );


		var loader = new THREE.ObjectLoader();

		var controls, effect, cameraVR, isVR,id;

		var events = {};
		this.width = 500;
		this.height = 500;



		
		var url = window.location.href;
		var arr = url.split("/");
		
		var base_url = arr[0] + "//" + arr[2];





		var add_notif = new Audio('static/sounds/appointment.mp3');
		var success_notif = new Audio('static/sounds/success.mp3');
		var delete_notif = new Audio('static/sounds/chat_sound.mp3');
		// audio.play();



		$(document).ready(function() {

			//start js rendering
			init_page('static/json/great_one.json');






            toast_options= {
		        "closeButton": true,
		        "debug": false,
		        "newestOnTop": false,
		        "progressBar": true,
		        "positionClass": "toast-top-right",
		        "preventDuplicates": true,
		        "onclick": null,
		        "showDuration": "300",
		        "hideDuration": "300",
		        "timeOut": "1500",
		        "extendedTimeOut": "1000",
		        "showEasing": "swing", //easeOutBounce swing
		        "hideEasing": "linear", //easeInBack linear
		        "closeEasing": "linear",
		        "showMethod": "fadeIn",//slideDown fadeIn
		        "hideMethod": "fadeOut", //slideUp fadeOut
		        "closeMethod": "fadeOut"
		    }





            stats_monitor();






            if(window.innerHeight > 740){
            	document.getElementsByClassName("ct_slider")[0].style.height = (window.innerHeight* 5/6) + "px";
            	// document.getElementsByClassName("control-sidebar-dark")[0].style.opacity = 1;
        	}else{
        		document.getElementsByClassName("ct_slider")[0].style.height = (window.innerHeight* 3/5) + "px";
        		// document.getElementsByClassName("control-sidebar-dark")[0].style.opacity = 0.5;
        	}


			$("#mb_1").addClass("active");
        });


        





		function init_page(url){
			var loader = new THREE.FileLoader();  
			loader.load( url, function ( model ) {
				init_model(JSON.parse(model));

				set_size( canvas_height, canvas_width);
				play();

				window.addEventListener( 'resize', function () {
					// set_size( window.innerHeight, window.innerWidth );
					set_size( $("#container").height(), $("#container").width());
				} );

			});
		}




		$(window).resize(function() {
            set_size( $("#container").height(), $("#container").width());
        });



		$(document).ajaxStart(function () {
			Pace.restart()
		});












		function init_model(json){
			
			init_render(json);

			set_scene( loader.parse( json.scene ) );

			set_camera( loader.parse( json.camera ) );

			set_light();

			init_ground();

			init_control();

			init_events(json);
		}



		function init_render(json) {
			renderer = new THREE.WebGLRenderer( { antialias: true } );
			renderer.setClearColor( 0x000000 );
			renderer.setPixelRatio( window.devicePixelRatio );
			// renderer.setSize( window.innerWidth, window.innerHeight );
			// renderer.shadowMap.renderSingleSided = false;


			if ( json.project.gammaInput ) renderer.gammaInput = true;
			if ( json.project.gammaOutput ) renderer.gammaOutput = true;

			if ( json.project.shadows ) {
				renderer.shadowMap.enabled = true;
			}



			// this.dom.appendChild( renderer.domElement );
			$("#container").append( renderer.domElement );
		}



		function set_scene(value){
			scene = value;
			scene.background = new THREE.Color( 0xffffff );
			scene.fog = new THREE.Fog( 0xffffff, 1000, 4000 );
			// scene.fog = new THREE.Fog( 0xcce0ff, 500, 10000 );

			if(scene.animations[0]){
				var mixer = new THREE.AnimationMixer( scene );
				mixer.clipAction( scene.animations[ 0 ] ).setDuration( 10 ).play();
				mixers.push( mixer );
			}				
		}



		function set_camera(value){
			camera = value;
			camera.aspect = this.width / this.height;
			camera.updateProjectionMatrix();

			cameraVR = new THREE.PerspectiveCamera(60, canvas_width / canvas_height, 1, 10000);
			cameraVR.projectionMatrix = camera.projectionMatrix;
			camera.position.set( 0, 120, 500 );//1000, 50, 1500 => h rotate, v rotate, camera pos
			camera.add( cameraVR );
		}



		function set_size(h, w){
			this.width = w;
			this.height = h;

			if ( camera ) {
				camera.aspect = w / h;
				camera.updateProjectionMatrix();

			}

			if ( renderer ) {
				renderer.setSize( w, h );
			}

			stats_monitor();
		}



		function set_light() {
			//LIGHT
			var light = [3];
			scene.add( new THREE.AmbientLight( 0x151515 ) );
			light[0] = new THREE.DirectionalLight( 0xdfebff, 1 ); //color , intensity
			light[0].position.set( 200, 300, 200 );//intencity, v pos, sh pos
			// light.position.set( 50, 200, 100 ); 
			light[0].castShadow = true;
			light[0].shadow.mapSize.width = 1024;
			light[0].shadow.mapSize.height = 512;//1024 512

			light[0].shadow.camera.near = 100;
			light[0].shadow.camera.far = 1200;
			light[0].shadow.camera.left = -1000;
			light[0].shadow.camera.right = 1000;
			light[0].shadow.camera.top = 350;
			light[0].shadow.camera.bottom = -350;
			
			scene.add( light[0] );


			light[ 1 ] = new THREE.DirectionalLight( 0xdfebff, 0.7 , 200 );
			light[ 1 ].position.set( -200, 300, 200 );
			scene.add( light[1] );


			light[ 2 ] = new THREE.DirectionalLight( 0xdfebff, 0.4 , 500 );
			light[ 2 ].position.set( 0, 400, -300 );
			scene.add( light[2] );
		}



		function init_ground() {
			//  GROUND
			var gt = new THREE.TextureLoader().load( "static/img/grasslight-big.jpg" );
			var gg = new THREE.PlaneBufferGeometry( 16000, 16000 );
			var gm = new THREE.MeshPhongMaterial( { color: 0xffffff, map: gt } );

			var ground = new THREE.Mesh( gg, gm );
			ground.rotation.x = - Math.PI / 2;
			ground.material.map.repeat.set( 64, 64 );
			ground.material.map.wrapS = THREE.RepeatWrapping;
			ground.material.map.wrapT = THREE.RepeatWrapping;
			// note that because the ground does not cast a shadow, .castShadow is left false
			ground.receiveShadow = true;
			scene.add( ground );
		}



		function init_control() {
			// CONTROLS
			cameraControls = new THREE.OrbitControls( camera, renderer.domElement );
			cameraControls.maxPolarAngle = Math.PI * 0.4;//rotate camera vertically
			// cameraControls.setAzimuthalAngle = -0.029893144818949887;
			cameraControls.target.set( 0, 150, 0 );
			cameraControls.maxDistance = 2000;
			cameraControls.update();
		}



		function init_events(json) {
			events = {
				init: [],
				start: [],
				stop: [],
				keydown: [],
				keyup: [],
				mousedown: [],
				mouseup: [],
				mousemove: [],
				touchstart: [],
				touchend: [],
				touchmove: [],
				update: []
			};




			var scriptWrapParams = 'player,renderer,scene,camera';
			var scriptWrapResultObj = {};

			for ( var eventKey in events ) {

				scriptWrapParams += ',' + eventKey;
				scriptWrapResultObj[ eventKey ] = eventKey;

			}




			var scriptWrapResult = JSON.stringify( scriptWrapResultObj ).replace( /\"/g, '' );

			for ( var uuid in json.scripts ) {

				var object = scene.getObjectByProperty( 'uuid', uuid, true );

				if ( object === undefined ) {

					console.warn( 'APP.Player: Script without object.', uuid );
					continue;

				}

				var scripts = json.scripts[ uuid ];

				for ( var i = 0; i < scripts.length; i ++ ) {

					var script = scripts[ i ];

					var functions = ( new Function( scriptWrapParams, script.source + '\nreturn ' + scriptWrapResult + ';' ).bind( object ) )( this, renderer, scene, camera );

					for ( var name in functions ) {

						if ( functions[ name ] === undefined ) continue;

						if ( events[ name ] === undefined ) {

							console.warn( 'APP.Player: Event type not supported (', name, ')' );
							continue;

						}

						events[ name ].push( functions[ name ].bind( object ) );

					}

				}

			}

			dispatch( events.init, arguments );
		}


		










		$(".load_model").click(function(){
			bid = $(this).attr("dt-id");
			$("#container").empty();
			if(bid == '1'){
				init_page('static/json/boolean/larm.json');
			}
			if(bid == '2'){
				init_page('static/json/boolean/shoulder.json');
			}
			if(bid == '3'){
				init_page('static/json/boolean/ankle.json');
			}
			if(bid == '4'){
				init_page('static/json/boolean/calve.json');
			}
			if(bid == '5'){
				init_page('static/json/boolean/thigh.json');
			}
			if(bid == '6'){
				init_page('static/json/boolean/body2.json');
			}
			if(bid == '7'){
				init_page('static/json/boolean/allanim.json');
			}
			console.log(bid);
		});








		$("#btn_play").click(function(){
			is_play = 1;			
			$("#ic_play").css('color', '#51b3eb');
			$("#ic_pause").css('color', '#666');
			play();
		});


		$("#btn_pause").click(function(){
			is_play = 0;
			$("#ic_pause").css('color', '#51b3eb');
			$("#ic_play").css('color', '#666');
			play();
		});










		var nv_sd = 0;
		$("#sb_tb_btn").click(function(){
			
			if($("#navbar").css("right") == '-230px'){
				nv_sd = 1;
				$("#ic_sb_tb_tb").removeClass("fa-bars");
				$("#ic_sb_tb_tb").addClass("fa-arrow-right");
			}else{
				nv_sd = 0;
				$("#ic_sb_tb_tb").removeClass("fa-arrow-right");
				$("#ic_sb_tb_tb").addClass("fa-bars");
			}
			stats_monitor();
		});







		var nv_mb = 0;
		$("#mb_tb_btn").click(function(){
			
			// if(nv_mb == 0){
			// 	nv_mb = 1;
			// 	$("#ic_sb_tb_tb").removeClass("fa-bars");
			// 	$("#ic_sb_tb_tb").addClass("fa-arrow-left");
			// }else{
			// 	nv_mb = 0;
			// 	$("#ic_sb_tb_tb").removeClass("fa-arrow-left");
			// 	$("#ic_sb_tb_tb").addClass("fa-bars");
			// }
		});







		function stats_monitor(){
			$("#stats").empty();
			// performance monitor
			stats = new Stats();
			stats.showPanel(1);// 0: fps, 1: ms, 2: mb, 3+: custom
			if(nv_sd == 1){
				if($(window).width() > 740){
					stats.dom.style.left = ($("#container").width()-270)+"px";
				}else{
					stats.dom.style.left =  "0px";
				}
			}else{
				if($(window).width() > 740){
					stats.dom.style.left = ($("#container").width()-40)+"px";
				}else{
					stats.dom.style.left = "0px";
				}
				
			}
			
			//$("#navbar").css("margin-left");
			if($(window).width() > 740){
				stats.dom.style.top = '50px';
			}else{
				stats.dom.style.top = '0px';
			}
			
			// stats.dom.style.position = 'relative';
			$("#stats").append( stats.dom );
		}








		function dispatch( array, event ) {

			for ( var i = 0, l = array.length; i < l; i ++ ) {

				array[ i ]( event );

			}
		}








		var prevTime, request;
		function animate( time ) {

			request = requestAnimationFrame( animate );

			try {

				dispatch( events.update, { time: time, delta: time - prevTime } );

			} catch ( e ) {

				console.error( ( e.message || e ), ( e.stack || "" ) );

			}

			if ( isVR === true ) {

				camera.updateMatrixWorld();

				controls.update();
				effect.render( scene, cameraVR );

			} else {

				var delta = clock.getDelta();
				if(is_play == 1){					
					for ( var i = 0; i < mixers.length; i ++ ) {
						mixers[ i ].update( delta );
					}
				}

				renderer.render( scene, camera );		

			}

			prevTime = time;


			// console.log(cameraControls.getAzimuthalAngle ());


			stats.update();
		}

		





		

		$(window).keypress(function (e) {
		  	if (e.key === ' ' || e.key === 'Spacebar') {
		  		if(is_play == 1){
		  			is_play = 0;
		  		}else{
		  			is_play = 1;
		  		}
		  		console_clip();
		  		play();		  		
		   		e.preventDefault();
		  	}
		});



		
		function console_clip(){
			var ref_min_max = [];
			clip_data = mixers[1]._actions[0].getClip();
			console.log(clip_data);
			for(j=0; j < clip_data.tracks.length; j++){
				cname  = clip_data.tracks[j].name.split(".");
				spname = cname[0]+"."+cname[1];
				if( cname[1] == "position" || name[2] == "position" ){
					ctimes = clip_data.tracks[j].times;
					timeKfo = THREE.AnimationUtils.getKeyframeOrder( ctimes );
					timeSa = THREE.AnimationUtils.sortedArray( ctimes, 1, timeKfo );//ctimes
					// frame_sorting(timeKfo, timeSa);

					cvalues = clip_data.tracks[j].values;
					valKfo = THREE.AnimationUtils.getKeyframeOrder( cvalues );
					valStride = clip_data.tracks[j].getValueSize();
					valSa = THREE.AnimationUtils.sortedArray( cvalues, valStride, timeKfo );

					var px, py, pz;
					var max_min_arr_x = [], max_min_arr_y = [], max_min_arr_z = [];

					for(i=0; i < valSa.length; i++){
						if((i+3) % 3 == 0){
							px = valSa[i];
							max_min_arr_x.push(px);
						}
						if((i+3) % 3 == 1){
							py = valSa[i];
							max_min_arr_y.push(py);
						}
						if((i+3) % 3 == 2){
							pz = valSa[i];
							max_min_arr_z.push(pz);
							dt = {
								"name" : spname,
								"position" : {
									"x" : {
										"val" : px,
										"min" : Math.min.apply(null, max_min_arr_x),
										"max" : Math.max.apply(null, max_min_arr_x)
									},
									"y" : {
										"val" : py,
										"min" : Math.min.apply(null, max_min_arr_y),
										"max" : Math.max.apply(null, max_min_arr_y)
									},
									"z" : {
										"val" : pz,
										"min" : Math.min.apply(null, max_min_arr_z),
										"max" : Math.max.apply(null, max_min_arr_z)
									}
								}
							}
							console.log(dt);
						}
					}

				}
			}
		}







		function onWindowResize() {

			// camera.aspect = window.innerWidth / window.innerHeight;
			camera.aspect = canvas_width / canvas_height;
			camera.updateProjectionMatrix();

			// renderer.setSize( window.innerWidth, window.innerHeight );
		}










		function play(){
			dispatch( events.start, arguments );

			request = requestAnimationFrame( animate );
			prevTime = performance.now();
		}








		function stop(){
			dispatch( events.stop, arguments );

			cancelAnimationFrame( request );
		}








		function dispose(){
			while ( this.dom.children.length ) {

				this.dom.removeChild( this.dom.firstChild );

			}

			renderer.dispose();

			camera = undefined;
			scene = undefined;
			renderer = undefined;
		}





	</script>



</body>
</html>